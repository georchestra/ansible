- name: install the datahub UI
  get_url:
    url: "{{ datahub.url }}"
    dest: "/var/www/georchestra/htdocs/datahub.zip"

- name: unzips the datahub archive
  unarchive:
    src: "/var/www/georchestra/htdocs/datahub.zip"
    dest: "/var/www/georchestra/htdocs"
    remote_src: yes

- name: templatize the env.js file
  template:
    src: "datahub-env.js.j2"
    dest: "/var/www/georchestra/htdocs/datahub/assets/env.js"

- name: removes the downloaded archive
  file:
    path: "/var/www/georchestra/htdocs/datahub.zip"
    state: absent

- name: templatize the apache config for datahub
  template:
    src: "datahub.conf.j2"
    dest: "/var/www/georchestra/conf/datahub.conf"
  notify: reload apache2

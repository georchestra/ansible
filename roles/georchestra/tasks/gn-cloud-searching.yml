- name: install the gn-cloud-searching microservice
  get_url:
    url: "{{ gn_cloud_searching.url }}"
    dest: "/usr/share/lib/searching.jar"

- name: templating a configuration file
  template:
    src: "geonetwork/gn-cloud-searching-application.yml.j2"
    dest: "/etc/georchestra/geonetwork/microservices/searching/application.yml"

- name: setup a systemd unit file
  template:
    src: "geonetwork/gn-cloud-searching.service.j2"
    dest: "/etc/systemd/system/gn-cloud-searching.service"
  register: gn_cloud_searching_unitfile

- name: start/enable the gn-cloud-searching service
  systemd:
    state: restarted
    daemon_reload: yes
    name: gn-cloud-searching
  when: gn_cloud_searching_unitfile.changed
